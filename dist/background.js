/*! For license information please see background.js.LICENSE.txt */
(()=>{"use strict";function e(e,t){var r="";switch(t){case"playwright-js":r+="class PageObject {\n",r+="  constructor(page) {\n",r+="    this.page = page;\n",e.forEach(function(e,t){var o=n(e);r+="    this.".concat(o," = '").concat(e.cssSelector||e.xpath,"';\n")}),r+="  }\n\n",e.forEach(function(e){var t=n(e),o="click".concat(t.charAt(0).toUpperCase()+t.slice(1));r+="  async ".concat(o,"() {\n"),r+="    await this.page.click(this.".concat(t,");\n"),r+="  }\n\n"}),r+="}\n";break;case"playwright-ts":r+="import { Page } from '@playwright/test';\n\n",r+="class PageObject {\n",r+="  private page: Page;\n",e.forEach(function(e,t){var o=n(e);r+="  private ".concat(o,": string;\n")}),r+="\n",r+="  constructor(page: Page) {\n",r+="    this.page = page;\n",e.forEach(function(e,t){var o=n(e);r+="    this.".concat(o," = '").concat(e.cssSelector||e.xpath,"';\n")}),r+="  }\n\n",e.forEach(function(e){var t=n(e),o="click".concat(t.charAt(0).toUpperCase()+t.slice(1));r+="  async ".concat(o,"(): Promise<void> {\n"),r+="    await this.page.click(this.".concat(t,");\n"),r+="  }\n\n"}),r+="}\n";break;case"cypress-js":r+="class PageObject {\n",e.forEach(function(e){var t=n(e);r+="  get ".concat(t,"() {\n"),r+="    return cy.get('".concat(e.cssSelector||e.xpath,"');\n"),r+="  }\n\n"}),r+="}\n\n",r+="const pageObject = new PageObject();\n";break;case"selenium-java":r+="public class PageObject {\n",r+="    private WebDriver driver;\n\n",r+="    public PageObject(WebDriver driver) {\n",r+="        this.driver = driver;\n",r+="    }\n\n",e.forEach(function(e){var t=n(e),o=e.cssSelector||e.xpath,a=e.cssSelector?"cssSelector":"xpath";r+="    public WebElement get".concat(t.charAt(0).toUpperCase()+t.slice(1),"() {\n"),r+="        return driver.findElement(By.".concat(a,'("').concat(o,'"));\n'),r+="    }\n\n"}),r+="}\n";break;case"selenium-python":r+="class PageObject:\n",r+="    def __init__(self, driver):\n",r+="        self.driver = driver\n\n",e.forEach(function(e){var t=n(e),o=e.cssSelector||e.xpath,a=e.cssSelector?"CSS_SELECTOR":"XPATH";r+="    def get_".concat(t,"(self):\n"),r+="        return self.driver.find_element(By.".concat(a,', "').concat(o,'")\n\n')})}return r}function n(e){return(e.id?e.id.replace(/[^a-zA-Z0-9]/g,""):e.className?e.className.split(" ")[0].replace(/[^a-zA-Z0-9]/g,""):e.textContent?e.textContent.toLowerCase().replace(/[^a-zA-Z0-9]/g,"").substring(0,20):e.tagName.toLowerCase())||"element"}var t=[{framework:{id:"playwright-js",name:"Playwright (JavaScript)",language:"JavaScript",description:"Modern end-to-end testing framework",icon:"üé≠"},generateTest:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.includeComments,a=void 0===o||o,c=r.usePageObjectModel,s=void 0!==c&&c,i=r.testName,l=void 0===i?"Generated Test":i,u=r.baseUrl,p=void 0===u?"https://example.com":u,d="";return a&&(d+="// Generated test using AI TestGen\n",d+="// Framework: Playwright (JavaScript)\n",d+="// Generated on: ".concat((new Date).toISOString(),"\n\n")),d+="import { test, expect } from '@playwright/test';\n\n",d+="// Playwright configuration for reports\n",d+="// Run with: npx playwright test --reporter=html\n",d+="// Or add to playwright.config.js:\n",d+="/*\n",d+="module.exports = {\n",d+="  reporter: [\n",d+="    ['html', { outputFolder: 'playwright-report' }],\n",d+="    ['json', { outputFile: 'test-results.json' }],\n",d+="    ['junit', { outputFile: 'test-results.xml' }]\n",d+="  ],\n",d+="  use: {\n",d+="    screenshot: 'only-on-failure',\n",d+="    video: 'retain-on-failure',\n",d+="    trace: 'on-first-retry'\n",d+="  }\n",d+="};\n",d+="*/\n\n",s&&(d+=e(t,"playwright-js"),d+="\n"),d+="test('".concat(l,"', async ({ page }) => {\n"),d+="  await page.goto('".concat(p,"');\n\n"),n.forEach(function(e,t){var r=e.element;if(r){a&&(d+="  // ".concat(e.type," on ").concat(r.tagName,"\n"));var o=r.cssSelector||r.xpath;switch(e.type){case"click":d+="  await page.click('".concat(o,"');\n");break;case"type":d+="  await page.fill('".concat(o,"', '").concat(e.value||"test input","');\n");break;case"hover":d+="  await page.hover('".concat(o,"');\n");break;case"select":d+="  await page.selectOption('".concat(o,"', '").concat(e.value||"option1","');\n");break;case"assert":d+="  await expect(page.locator('".concat(o,"')).toBeVisible();\n");break;default:d+="  // TODO: Implement ".concat(e.type," action\n")}t<n.length-1&&(d+="\n")}}),d+="});\n"}},{framework:{id:"playwright-ts",name:"Playwright (TypeScript)",language:"TypeScript",description:"Modern end-to-end testing framework with TypeScript support",icon:"üé≠"},generateTest:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.includeComments,a=void 0===o||o,c=r.usePageObjectModel,s=void 0!==c&&c,i=r.testName,l=void 0===i?"Generated Test":i,u=r.baseUrl,p=void 0===u?"https://example.com":u,d="";return a&&(d+="// Generated test using AI TestGen\n",d+="// Framework: Playwright (TypeScript)\n",d+="// Generated on: ".concat((new Date).toISOString(),"\n\n")),d+="import { test, expect, Page } from '@playwright/test';\n\n",d+="// Playwright configuration for reports\n",d+="// Run with: npx playwright test --reporter=html\n",d+="// Or add to playwright.config.ts:\n",d+="/*\n",d+="export default {\n",d+="  reporter: [\n",d+="    ['html', { outputFolder: 'playwright-report' }],\n",d+="    ['json', { outputFile: 'test-results.json' }],\n",d+="    ['junit', { outputFile: 'test-results.xml' }]\n",d+="  ],\n",d+="  use: {\n",d+="    screenshot: 'only-on-failure',\n",d+="    video: 'retain-on-failure',\n",d+="    trace: 'on-first-retry'\n",d+="  }\n",d+="};\n",d+="*/\n\n",s&&(d+=e(t,"playwright-ts"),d+="\n"),d+="test('".concat(l,"', async ({ page }: { page: Page }) => {\n"),d+="  await page.goto('".concat(p,"');\n\n"),n.forEach(function(e,t){var r=e.element;if(r){a&&(d+="  // ".concat(e.type," on ").concat(r.tagName,"\n"));var o=r.cssSelector||r.xpath;switch(e.type){case"click":d+="  await page.click('".concat(o,"');\n");break;case"type":d+="  await page.fill('".concat(o,"', '").concat(e.value||"test input","');\n");break;case"hover":d+="  await page.hover('".concat(o,"');\n");break;case"select":d+="  await page.selectOption('".concat(o,"', '").concat(e.value||"option1","');\n");break;case"assert":d+="  await expect(page.locator('".concat(o,"')).toBeVisible();\n");break;default:d+="  // TODO: Implement ".concat(e.type," action\n")}t<n.length-1&&(d+="\n")}}),d+="});\n"}},{framework:{id:"playwright-python",name:"Playwright (Python)",language:"Python",description:"Modern end-to-end testing framework for Python",icon:"üé≠"},generateTest:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.includeComments,a=void 0===o||o,c=r.usePageObjectModel,s=void 0!==c&&c,i=r.testName,l=void 0===i?"test_generated":i,u=r.baseUrl,p=void 0===u?"https://example.com":u,d="";return a&&(d+="# Generated test using AI TestGen\n",d+="# Framework: Playwright (Python)\n",d+="# Generated on: ".concat((new Date).toISOString(),"\n\n")),d+="import pytest\nfrom playwright.sync_api import Page, expect\n\n",s&&(d+=e(t,"playwright-python"),d+="\n"),d+="def ".concat(l,"(page: Page):\n"),d+='    page.goto("'.concat(p,'")\n\n'),n.forEach(function(e,t){var r=e.element;if(r){a&&(d+="    # ".concat(e.type," on ").concat(r.tagName,"\n"));var o=r.cssSelector||r.xpath;switch(e.type){case"click":d+='    page.click("'.concat(o,'")\n');break;case"type":d+='    page.fill("'.concat(o,'", "').concat(e.value||"test input",'")\n');break;case"hover":d+='    page.hover("'.concat(o,'")\n');break;case"select":d+='    page.select_option("'.concat(o,'", "').concat(e.value||"option1",'")\n');break;case"assert":d+='    expect(page.locator("'.concat(o,'")).to_be_visible()\n');break;default:d+="    # TODO: Implement ".concat(e.type," action\n")}t<n.length-1&&(d+="\n")}}),d}},{framework:{id:"cypress-js",name:"Cypress (JavaScript)",language:"JavaScript",description:"Fast, easy and reliable testing for anything that runs in a browser",icon:"üå≤"},generateTest:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.includeComments,a=void 0===o||o,c=r.usePageObjectModel,s=void 0!==c&&c,i=r.testName,l=void 0===i?"Generated Test":i,u=r.baseUrl,p=void 0===u?"https://example.com":u,d="";return a&&(d+="// Generated test using AI TestGen\n",d+="// Framework: Cypress (JavaScript)\n",d+="// Generated on: ".concat((new Date).toISOString(),"\n\n")),s&&(d+=e(t,"cypress-js"),d+="\n"),d+="describe('".concat(l,"', () => {\n"),d+="  it('should perform automated test actions', () => {\n",d+="    cy.visit('".concat(p,"');\n\n"),n.forEach(function(e,t){var r=e.element;if(r){a&&(d+="    // ".concat(e.type," on ").concat(r.tagName,"\n"));var o=r.cssSelector||r.xpath;switch(e.type){case"click":d+="    cy.get('".concat(o,"').click();\n");break;case"type":d+="    cy.get('".concat(o,"').type('").concat(e.value||"test input","');\n");break;case"hover":d+="    cy.get('".concat(o,"').trigger('mouseover');\n");break;case"select":d+="    cy.get('".concat(o,"').select('").concat(e.value||"option1","');\n");break;case"assert":d+="    cy.get('".concat(o,"').should('be.visible');\n");break;default:d+="    // TODO: Implement ".concat(e.type," action\n")}t<n.length-1&&(d+="\n")}}),d+="  });\n",d+="});\n"}},{framework:{id:"selenium-java",name:"Selenium (Java)",language:"Java",description:"Browser automation framework for Java",icon:"‚òï"},generateTest:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.includeComments,a=void 0===o||o,c=r.usePageObjectModel,s=void 0!==c&&c,i=r.testName,l=void 0===i?"GeneratedTest":i,u=r.baseUrl,p=void 0===u?"https://example.com":u,d="";return a&&(d+="// Generated test using AI TestGen\n",d+="// Framework: Selenium (Java)\n",d+="// Generated on: ".concat((new Date).toISOString(),"\n\n")),d+="import org.junit.jupiter.api.Test;\n",d+="import org.junit.jupiter.api.BeforeEach;\n",d+="import org.junit.jupiter.api.AfterEach;\n",d+="import org.openqa.selenium.WebDriver;\n",d+="import org.openqa.selenium.WebElement;\n",d+="import org.openqa.selenium.By;\n",d+="import org.openqa.selenium.chrome.ChromeDriver;\n",d+="import org.openqa.selenium.support.ui.Select;\n",d+="import org.openqa.selenium.interactions.Actions;\n\n",s&&(d+=e(t,"selenium-java"),d+="\n"),d+="public class ".concat(l," {\n"),d+="    private WebDriver driver;\n",d+="    private Actions actions;\n\n",d+="    @BeforeEach\n",d+="    public void setUp() {\n",d+="        driver = new ChromeDriver();\n",d+="        actions = new Actions(driver);\n",d+='        driver.get("'.concat(p,'");\n'),d+="    }\n\n",d+="    @Test\n",d+="    public void testAutomatedActions() {\n",n.forEach(function(e,t){var r=e.element;if(r){a&&(d+="        // ".concat(e.type," on ").concat(r.tagName,"\n"));var o=r.cssSelector||r.xpath,c=r.cssSelector?"cssSelector":"xpath";switch(e.type){case"click":d+="        WebElement element".concat(t," = driver.findElement(By.").concat(c,'("').concat(o,'"));\n'),d+="        element".concat(t,".click();\n");break;case"type":d+="        WebElement element".concat(t," = driver.findElement(By.").concat(c,'("').concat(o,'"));\n'),d+="        element".concat(t,'.sendKeys("').concat(e.value||"test input",'");\n');break;case"hover":d+="        WebElement element".concat(t," = driver.findElement(By.").concat(c,'("').concat(o,'"));\n'),d+="        actions.moveToElement(element".concat(t,").perform();\n");break;case"select":d+="        WebElement element".concat(t," = driver.findElement(By.").concat(c,'("').concat(o,'"));\n'),d+="        Select select".concat(t," = new Select(element").concat(t,");\n"),d+="        select".concat(t,'.selectByVisibleText("').concat(e.value||"option1",'");\n');break;case"assert":d+="        WebElement element".concat(t," = driver.findElement(By.").concat(c,'("').concat(o,'"));\n'),d+="        assert element".concat(t,".isDisplayed();\n");break;default:d+="        // TODO: Implement ".concat(e.type," action\n")}t<n.length-1&&(d+="\n")}}),d+="    }\n\n",d+="    @AfterEach\n",d+="    public void tearDown() {\n",d+="        if (driver != null) {\n",d+="            driver.quit();\n",d+="        }\n",d+="    }\n",d+="}\n"}},{framework:{id:"selenium-python",name:"Selenium (Python)",language:"Python",description:"Browser automation framework for Python",icon:"üêç"},generateTest:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.includeComments,a=void 0===o||o,c=r.usePageObjectModel,s=void 0!==c&&c,i=r.testName,l=void 0===i?"test_generated":i,u=r.baseUrl,p=void 0===u?"https://example.com":u,d="";return a&&(d+="# Generated test using AI TestGen\n",d+="# Framework: Selenium (Python)\n",d+="# Generated on: ".concat((new Date).toISOString(),"\n\n")),d+="import pytest\n",d+="from selenium import webdriver\n",d+="from selenium.webdriver.common.by import By\n",d+="from selenium.webdriver.support.ui import Select\n",d+="from selenium.webdriver.common.action_chains import ActionChains\n",d+="from selenium.webdriver.support.ui import WebDriverWait\n",d+="from selenium.webdriver.support import expected_conditions as EC\n\n",s&&(d+=e(t,"selenium-python"),d+="\n"),d+="class TestAutomation:\n",d+="    def setup_method(self):\n",d+="        self.driver = webdriver.Chrome()\n",d+='        self.driver.get("'.concat(p,'")\n'),d+="        self.wait = WebDriverWait(self.driver, 10)\n\n",d+="    def teardown_method(self):\n",d+="        self.driver.quit()\n\n",d+="    def ".concat(l,"(self):\n"),n.forEach(function(e,t){var r=e.element;if(r){a&&(d+="        # ".concat(e.type," on ").concat(r.tagName,"\n"));var o=r.cssSelector||r.xpath,c=r.cssSelector?"CSS_SELECTOR":"XPATH";switch(e.type){case"click":d+="        element = self.wait.until(EC.element_to_be_clickable((By.".concat(c,', "').concat(o,'")))\n'),d+="        element.click()\n";break;case"type":d+="        element = self.wait.until(EC.presence_of_element_located((By.".concat(c,', "').concat(o,'")))\n'),d+='        element.send_keys("'.concat(e.value||"test input",'")\n');break;case"hover":d+="        element = self.driver.find_element(By.".concat(c,', "').concat(o,'")\n'),d+="        ActionChains(self.driver).move_to_element(element).perform()\n";break;case"select":d+="        element = self.driver.find_element(By.".concat(c,', "').concat(o,'")\n'),d+="        select = Select(element)\n",d+='        select.select_by_visible_text("'.concat(e.value||"option1",'")\n');break;case"assert":d+="        element = self.wait.until(EC.visibility_of_element_located((By.".concat(c,', "').concat(o,'")))\n'),d+="        assert element.is_displayed()\n";break;default:d+="        # TODO: Implement ".concat(e.type," action\n")}t<n.length-1&&(d+="\n")}}),d}}];function r(e){return t.find(function(n){return n.framework.id===e})}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=u(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==t.return||t.return()}finally{if(s)throw a}}}}function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach(function(n){i(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function i(e,n,t){return(n=function(e){var n=function(e){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=o(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,n){if(e){if("string"==typeof e)return p(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?p(e,n):void 0}}function p(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function d(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var i=r&&r.prototype instanceof s?r:s,l=Object.create(i.prototype);return m(l,"_invoke",function(t,r,o){var a,s,i,l=0,u=o||[],p=!1,d={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return a=n,s=0,i=e,d.n=t,c}};function m(t,r){for(s=t,i=r,n=0;!p&&l&&!o&&n<u.length;n++){var o,a=u[n],m=d.p,f=a[2];t>3?(o=f===r)&&(i=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=t<2&&m<a[1])?(s=0,d.v=r,d.n=a[1]):m<f&&(o=t<3||a[0]>r||r>f)&&(a[4]=t,a[5]=r,d.n=f,s=0))}if(o||t>1)return c;throw p=!0,r}return function(o,u,f){if(l>1)throw TypeError("Generator is already running");for(p&&1===u&&m(u,f),s=u,i=f;(n=s<2?e:i)||!p;){a||(s?s<3?(s>1&&(d.n=-1),m(s,i)):d.n=i:d.v=i);try{if(l=2,a){if(s||(o="next"),n=a[o]){if(!(n=n.call(a,i)))throw TypeError("iterator result is not an object");if(!n.done)return n;i=n.value,s<2&&(s=0)}else 1===s&&(n=a.return)&&n.call(a),s<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((n=(p=d.n<0)?i:t.call(r,d))!==c)break}catch(n){a=e,s=1,i=n}finally{l=1}}return{value:n,done:p}}}(t,o,a),!0),l}var c={};function s(){}function i(){}function l(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(m(n={},r,function(){return this}),n),p=l.prototype=s.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,m(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return i.prototype=l,m(p,"constructor",l),m(l,"constructor",i),i.displayName="GeneratorFunction",m(l,o,"GeneratorFunction"),m(p),m(p,o,"Generator"),m(p,r,function(){return this}),m(p,"toString",function(){return"[object Generator]"}),(d=function(){return{w:a,m:f}})()}function m(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}m=function(e,n,t,r){function a(n,t){m(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},m(e,n,t,r)}function f(e,n,t,r,o,a,c){try{var s=e[a](c),i=s.value}catch(e){return void t(e)}s.done?n(i):Promise.resolve(i).then(r,o)}function h(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var a=e.apply(n,t);function c(e){f(a,r,o,c,s,"next",e)}function s(e){f(a,r,o,c,s,"throw",e)}c(void 0)})}}var g=[];function v(e,n,t,r){return y.apply(this,arguments)}function y(){return(y=h(d().m(function e(n,t,r,o){var a,c,s,i,l,u,p,m,f,h,v,y;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return a=Date.now().toString()+Math.random().toString(36).substr(2,9),c=Date.now(),s={url:n,method:t.method||"GET",headers:t.headers||{},body:t.body||"",timestamp:c},e.p=1,i=Date.now(),e.n=2,fetch(n,t);case 2:return l=e.v,u=Date.now(),e.n=3,l.text();case 3:return p=e.v,m={status:l.status,statusText:l.statusText,headers:Object.fromEntries(l.headers.entries()),body:p,timestamp:u,duration:u-i},f={id:a,provider:r,model:o,request:s,response:m},g.push(f),e.a(2,new Response(p,{status:l.status,statusText:l.statusText,headers:l.headers}));case 4:throw e.p=4,y=e.v,h={status:0,statusText:"Network Error",headers:{},body:"",timestamp:Date.now(),duration:Date.now()-c},v={id:a,provider:r,model:o,request:s,response:h,error:y instanceof Error?y.message:"Unknown error"},g.push(v),y;case 5:return e.a(2)}},e,null,[[1,4]])}))).apply(this,arguments)}function b(e,n){try{chrome.runtime.sendMessage({action:"testGenerationError",error:e})}catch(e){console.log("Could not send error to popup (popup might be closed):",e)}n({error:e})}function w(e,n){return k.apply(this,arguments)}function k(){return(k=h(d().m(function e(n,t){var o,a,c,s,i,u,p,m,f,h,v,y;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("üéØ Background: Handling test generation request:",n),g=[],e.n=1,$();case 1:if(o=e.v,console.log("‚öôÔ∏è Background: Current settings:",o),o){e.n=2;break}return b("Extension settings not found. Please configure the extension first.",t),e.a(2);case 2:if(o.selectedAIProvider){e.n=3;break}return b("No AI provider selected. Please select a provider in settings.",t),e.a(2);case 3:if(a="","local"!==o.selectedAIProvider){e.n=5;break}if(null!==(c=o.localSetup)&&void 0!==c&&c.endpoint){e.n=4;break}return b("Local endpoint not configured. Please set up local provider in settings.",t),e.a(2);case 4:e.n=8;break;case 5:if("openrouter"!==o.selectedAIProvider){e.n=7;break}if(a=(null===(s=o.openRouterConfig)||void 0===s?void 0:s.apiKey)||""){e.n=6;break}return b("OpenRouter API key not configured. Please add your API key in settings.",t),e.a(2);case 6:e.n=8;break;case 7:if(a=(null===(i=o.apiKeys)||void 0===i?void 0:i[o.selectedAIProvider])||""){e.n=8;break}return u=o.selectedAIProvider.charAt(0).toUpperCase()+o.selectedAIProvider.slice(1),b("".concat(u," API key not configured. Please add your API key in settings."),t),e.a(2);case 8:if(p=r(o.selectedFramework)){e.n=9;break}return b("Unsupported test framework",t),e.a(2);case 9:if(m="",!n.userPrompt||!n.userPrompt.trim()){e.n=11;break}return console.log("ü§ñ Using AI generation for custom prompt:",n.userPrompt),console.log("üîß AI Provider:",o.selectedAIProvider,"Framework:",p.framework.name),e.n=10,P(o.selectedAIProvider,a,n,p.framework,o);case 10:m=e.v,console.log("‚úÖ Generated code length:",m.length),e.n=14;break;case 11:if(!(n.elements&&n.elements.length>0)){e.n=12;break}f={includeComments:o.includeComments,usePageObjectModel:o.usePageObjectModel,testName:n.testName||"Generated Test",baseUrl:n.baseUrl||"https://example.com"},m=p.generateTest(n.actions||[],n.elements,f),e.n=14;break;case 12:return e.n=13,P(o.selectedAIProvider,a,n,p.framework,o);case 13:m=e.v;case 14:h={framework:p.framework,code:m,actions:n.actions||[],timestamp:Date.now(),apiCalls:l(g)};try{chrome.runtime.sendMessage({action:"testGenerated",test:h})}catch(e){console.log("Could not send to popup (popup might be closed):",e)}t({success:!0,test:h}),e.n=16;break;case 15:e.p=15,y=e.v,console.error("Error generating test:",y),v=y instanceof Error?y.message:"Unknown error occurred";try{chrome.runtime.sendMessage({action:"testGenerationError",error:v})}catch(e){console.log("Could not send error to popup (popup might be closed):",e)}t({error:v});case 16:return e.a(2)}},e,null,[[0,15]])}))).apply(this,arguments)}function P(e,n,t,r,o){return E.apply(this,arguments)}function E(){return(E=h(d().m(function e(n,t,r,o,a){var c,s,i;return d().w(function(e){for(;;)switch(e.n){case 0:c=O(r,o,a),s=null==a?void 0:a.selectedModel[n],i=n,e.n="openai"===i?1:"anthropic"===i?3:"deepseek"===i?5:"groq"===i?7:"local"===i?9:"openrouter"===i?11:"manual"===i?13:15;break;case 1:return e.n=2,T(t,c,s);case 2:case 4:case 6:case 8:case 10:case 12:case 14:return e.a(2,e.v);case 3:return e.n=4,A(t,c,s);case 5:return e.n=6,C(t,c,s);case 7:return e.n=8,_(t,c,s);case 9:return e.n=10,U(null==a?void 0:a.localSetup,c);case 11:return e.n=12,D(null==a?void 0:a.openRouterConfig,c,s);case 13:return e.n=14,R(null==a?void 0:a.customProviderConfig,c);case 15:throw new Error("Unsupported AI provider: ".concat(n));case 16:return e.a(2)}},e)}))).apply(this,arguments)}function S(e){var n=e.trim();return(n=(n=(n=(n=n.replace(/^[A-Za-z\s\(\)]+\([A-Za-z\s]+\)\s*\([A-Za-z\s]+\)\s*\n/,"")).replace(/^```(?:typescript|javascript|python|java|js|ts)?\s*\n/,"")).replace(/\n```\s*$/,"")).replace(/^```.*\n/,"").replace(/\n```.*$/,"")).trim()}function O(e,n,t){var r=e.actions,o=(e.elements,e.userPrompt),a=e.pageContext,c=n||e.framework,s=!1!==(null==t?void 0:t.includeComments),i=!0===(null==t?void 0:t.usePageObjectModel),l="Generate ".concat(c.name," test code in ").concat(c.language," for the following scenario:\n\nUser Request: ").concat(o||"Generate test for the selected elements");return a&&(l+="\n\nPage Context:\n- URL: ".concat(a.url,"\n- Title: ").concat(a.title,"\n- Selected Elements: ").concat(a.elementCount)),l+="\n\nElements and Actions:\n".concat((r||[]).map(function(e,n){var t=e.element,r="".concat(n+1,". ").concat(e.type.toUpperCase()," on element: ").concat(t.tagName).concat(t.id?"#".concat(t.id):"").concat(t.className?".".concat(t.className):"","\n     Selector: ").concat(t.cssSelector,"\n     XPath: ").concat(t.xpath,"\n     Text Content: ").concat(t.textContent?t.textContent.substring(0,100):"N/A");if(t.context&&(r+="\n     Position: ".concat(t.context.position.x,", ").concat(t.context.position.y," (").concat(t.context.position.width,"x").concat(t.context.position.height,")\n     Visible: ").concat(t.context.visible)),t.accessibility){var o=t.accessibility;(o.role||o.ariaLabel||o.title)&&(r+="\n     Accessibility: ".concat(o.role?'role="'.concat(o.role,'"'):""," ").concat(o.ariaLabel?'aria-label="'.concat(o.ariaLabel,'"'):""," ").concat(o.title?'title="'.concat(o.title,'"'):"").trim())}return r+"\n     ".concat(e.value?"Value: ".concat(e.value):"","\n     Description: ").concat(e.description)}).join("\n"),"\n\nRequirements:\n- Use modern best practices for ").concat(c.name,"\n- Include proper waits and error handling\n- Use reliable selectors (prefer CSS selectors over XPath when possible)\n- Follow ").concat(c.language," coding conventions\n- Make the test maintainable and readable\n- Handle potential race conditions and flaky elements\n- Use appropriate assertions for validation"),s&&(l+="\n- Add descriptive comments explaining each step"),i&&(l+="\n- Structure the code using Page Object Model pattern"),l+"\n\nGenerate only the test code without explanations or markdown formatting."}function T(e,n,t){return x.apply(this,arguments)}function x(){return(x=h(d().m(function e(n,t,r){var o,a,c,s;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,v("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({model:r||"gpt-4",messages:[{role:"system",content:"You are an expert test automation engineer specializing in creating robust, maintainable test code. Focus on best practices, proper error handling, and reliable selectors."},{role:"user",content:t}],temperature:.1,max_tokens:3e3})},"openai",r||"gpt-4");case 1:return o=e.v,e.n=2,o.json();case 2:if(a=e.v,o.ok){e.n=3;break}throw new Error((null===(c=a.error)||void 0===c?void 0:c.message)||"OpenAI API error");case 3:return s=a.choices[0].message.content,e.a(2,S(s))}},e)}))).apply(this,arguments)}function A(e,n,t){return j.apply(this,arguments)}function j(){return(j=h(d().m(function e(n,t,r){var o,a,c,s;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,v("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"x-api-key":n,"Content-Type":"application/json","anthropic-version":"2023-06-01"},body:JSON.stringify({model:r||"claude-3-sonnet-20240229",max_tokens:3e3,messages:[{role:"user",content:t}]})},"Anthropic",r||"claude-3-sonnet-20240229");case 1:return o=e.v,e.n=2,o.json();case 2:if(a=e.v,o.ok){e.n=3;break}throw new Error((null===(c=a.error)||void 0===c?void 0:c.message)||"Anthropic API error");case 3:return s=a.content[0].text,e.a(2,S(s))}},e)}))).apply(this,arguments)}function C(e,n,t){return I.apply(this,arguments)}function I(){return(I=h(d().m(function e(n,t,r){var o,a,c,s;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,v("https://api.deepseek.com/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({model:r||"deepseek-chat",messages:[{role:"system",content:"You are an expert test automation engineer specializing in creating robust, maintainable test code. Focus on best practices, proper error handling, and reliable selectors."},{role:"user",content:t}],temperature:.1,max_tokens:3e3})},"DeepSeek",r||"deepseek-chat");case 1:return o=e.v,e.n=2,o.json();case 2:if(a=e.v,o.ok){e.n=3;break}throw new Error((null===(c=a.error)||void 0===c?void 0:c.message)||"DeepSeek API error");case 3:return s=a.choices[0].message.content,e.a(2,S(s))}},e)}))).apply(this,arguments)}function _(e,n,t){return G.apply(this,arguments)}function G(){return(G=h(d().m(function e(n,t,r){var o,a,c,s;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,v("https://api.groq.com/openai/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({model:r||"llama-3.1-70b-versatile",messages:[{role:"system",content:"You are an expert test automation engineer specializing in creating robust, maintainable test code. Focus on best practices, proper error handling, and reliable selectors."},{role:"user",content:t}],temperature:.1,max_tokens:3e3})},"Groq",r||"llama-3.1-70b-versatile");case 1:return o=e.v,e.n=2,o.json();case 2:if(a=e.v,o.ok){e.n=3;break}throw new Error((null===(c=a.error)||void 0===c?void 0:c.message)||"Groq API error");case 3:return s=a.choices[0].message.content,e.a(2,S(s))}},e)}))).apply(this,arguments)}function U(e,n){return N.apply(this,arguments)}function N(){return(N=h(d().m(function e(n,t){var r,o,a,c,s,i,l,u,p,m,f,h,g,y,b,w;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n&&t){e.n=1;break}throw new Error("Local setup configuration or prompt missing. Please configure endpoint and model in settings.");case 1:if(n.endpoint){e.n=2;break}throw new Error("Local AI endpoint not configured. Please set endpoint (e.g., http://localhost:11434) in settings.");case 2:if(n.model){e.n=3;break}throw new Error("Local AI model not specified. Please set model name (e.g., llama3.1:8b, codellama) in settings.");case 3:if(r=n.endpoint.trim(),o=r.includes("/v1")||r.endsWith("/v1"),a="You are an expert test automation engineer specializing in creating robust, maintainable test code. Focus on best practices, proper error handling, and reliable selectors.",e.p=4,i=null,!o){e.n=8;break}return l=r.endsWith("/v1")?"".concat(r,"/chat/completions"):"".concat(r,"/v1/chat/completions"),u={model:n.model,messages:[{role:"system",content:a},{role:"user",content:t}],temperature:n.temperature||.1,max_tokens:n.maxTokens||3e3,stream:!1},c=l,s=u,e.n=5,v(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},"Local Provider",n.model);case 5:if(404!==(i=e.v).status){e.n=7;break}return p=r.endsWith("/v1")?"".concat(r,"/completions"):"".concat(r,"/v1/completions"),m={model:n.model,prompt:"".concat(a,"\n\n").concat(t),temperature:n.temperature||.1,max_tokens:n.maxTokens||3e3,stream:!1},c=p,s=m,e.n=6,v(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},"Local Provider",n.model);case 6:i=e.v;case 7:e.n=10;break;case 8:return c="".concat(r,"/api/generate"),s={model:n.model,prompt:"".concat(a,"\n\n").concat(t),temperature:n.temperature||.1,max_tokens:n.maxTokens||3e3,stream:!1},e.n=9,v(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},"Local Provider",n.model);case 9:i=e.v;case 10:if(i){e.n=11;break}throw new Error("No response from local AI service");case 11:if(i.ok){e.n=16;break}return e.n=12,i.text().catch(function(){return i.statusText});case 12:if(f=e.v,403!==i.status){e.n=13;break}throw new Error("Local AI service forbidden (403). Check if the service is accessible at ".concat(n.endpoint));case 13:if(404!==i.status){e.n=14;break}throw new Error("Endpoint not found (404). Verify the endpoint URL and model name. URL tried: ".concat(c));case 14:if(!(i.status>=500)){e.n=15;break}throw new Error("Local AI service error (".concat(i.status,"). Error: ").concat(f));case 15:throw new Error("Local provider error: ".concat(f," (").concat(i.status,")"));case 16:return e.n=17,i.json();case 17:if(h=e.v,g=o?(null===(y=h.choices)||void 0===y||null===(y=y[0])||void 0===y||null===(y=y.message)||void 0===y?void 0:y.content)||(null===(b=h.choices)||void 0===b||null===(b=b[0])||void 0===b?void 0:b.text)||h.content||h.text:h.response||h.text||h.content){e.n=18;break}throw new Error("No content received from local AI service. Response format may be unexpected.");case 18:return e.a(2,S(g));case 19:if(e.p=19,"TypeError"!==(w=e.v).name||!w.message.includes("fetch")){e.n=20;break}throw new Error("Cannot connect to local AI service at ".concat(n.endpoint,". Please ensure the service is running and accessible."));case 20:throw w;case 21:return e.a(2)}},e,null,[[4,19]])}))).apply(this,arguments)}function D(e,n,t){return B.apply(this,arguments)}function B(){return(B=h(d().m(function e(n,t,r){var o,a,c,s,i;return d().w(function(e){for(;;)switch(e.n){case 0:if(n&&t&&n.apiKey){e.n=1;break}throw new Error("OpenRouter configuration or prompt missing");case 1:if(r){e.n=2;break}throw new Error("OpenRouter model not specified");case 2:return e.n=3,v("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer ".concat(n.apiKey),"Content-Type":"application/json","HTTP-Referer":"https://ai-testgen-extension.com","X-Title":"AI TestGen Extension"},body:JSON.stringify({model:r,messages:[{role:"system",content:"You are an expert test automation engineer specializing in creating robust, maintainable test code. Focus on best practices, proper error handling, and reliable selectors."},{role:"user",content:t}],temperature:n.temperature||.1,max_tokens:n.maxTokens||3e3})},"OpenRouter",r);case 3:if((o=e.v).ok){e.n=5;break}return e.n=4,o.json();case 4:throw c=e.v,new Error((null===(a=c.error)||void 0===a?void 0:a.message)||"OpenRouter API error");case 5:return e.n=6,o.json();case 6:return s=e.v,i=s.choices[0].message.content,e.a(2,S(i))}},e)}))).apply(this,arguments)}function R(e,n){return M.apply(this,arguments)}function M(){return(M=h(d().m(function e(n,t){var r,o,a,c,i;return d().w(function(e){for(;;)switch(e.n){case 0:if(n&&t){e.n=1;break}throw new Error("Custom provider configuration or prompt missing");case 1:if(n.baseUrl&&n.apiKey&&n.model){e.n=2;break}throw new Error("Custom provider configuration is incomplete");case 2:return e.n=3,v("".concat(n.baseUrl,"/chat/completions"),{method:"POST",headers:s({Authorization:"Bearer ".concat(n.apiKey),"Content-Type":"application/json"},n.headers),body:JSON.stringify({model:n.model,messages:[{role:"system",content:"You are an expert test automation engineer specializing in creating robust, maintainable test code. Focus on best practices, proper error handling, and reliable selectors."},{role:"user",content:t}],temperature:n.temperature||.1,max_tokens:n.maxTokens||3e3})},"Custom Provider",n.model);case 3:if((r=e.v).ok){e.n=5;break}return e.n=4,r.json();case 4:throw a=e.v,new Error((null===(o=a.error)||void 0===o?void 0:o.message)||"Custom provider API error");case 5:return e.n=6,r.json();case 6:return c=e.v,i=c.choices[0].message.content,e.a(2,S(i))}},e)}))).apply(this,arguments)}function F(e){return L.apply(this,arguments)}function L(){return(L=h(d().m(function e(n){var t,r,o,a,c,s,i,l,u;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch("https://openrouter.ai/api/v1/models",{method:"GET",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json","HTTP-Referer":"https://ai-testgen-extension.com","X-Title":"AI TestGen Extension","User-Agent":"AI-TestGen-Extension/1.0.0"}});case 1:if((o=e.v).ok){e.n=3;break}return e.n=2,o.text();case 2:throw a=e.v,console.error("OpenRouter API error response:",a),new Error("OpenRouter API error: ".concat(o.status," ").concat(o.statusText,". ").concat(a.includes("<!DOCTYPE")?"Invalid API key or endpoint.":a));case 3:if((c=o.headers.get("content-type"))&&c.includes("application/json")){e.n=5;break}return e.n=4,o.text();case 4:throw s=e.v,console.error("Non-JSON response from OpenRouter:",s),new Error("OpenRouter API returned non-JSON response. Please check your API key.");case 5:return e.n=6,o.json();case 6:if((i=e.v)&&i.data){e.n=7;break}throw new Error("Invalid response format from OpenRouter API");case 7:return console.log("OpenRouter API response:",i),console.log("Total models received:",null===(t=i.data)||void 0===t?void 0:t.length),l=(null===(r=i.data)||void 0===r?void 0:r.map(function(e){return{id:e.id,name:e.name||e.id,context_length:e.context_length||0,pricing:e.pricing||{}}}))||[],console.log("Processed models:",l.length),console.log("Sample models:",l.slice(0,5)),e.a(2,l);case 8:if(e.p=8,u=e.v,console.error("Error fetching OpenRouter models:",u),!(u instanceof Error&&u.message.includes("Unexpected token"))){e.n=9;break}throw new Error("OpenRouter API returned HTML instead of JSON. Please check your API key and try again.");case 9:throw u;case 10:return e.a(2)}},e,null,[[0,8]])}))).apply(this,arguments)}function J(e,n){return W.apply(this,arguments)}function W(){return(W=h(d().m(function e(n,t){var r,o,c,s,i,l,u,p,m;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,chrome.storage.local.get(["savedTests"]);case 1:return r=e.v,(o=r.savedTests||[]).push(n),e.n=2,chrome.storage.local.set({savedTests:o});case 2:return e.p=2,e.n=3,chrome.tabs.query({});case 3:c=e.v,s=a(c),e.p=4,s.s();case 5:if((i=s.n()).done){e.n=10;break}if(!(l=i.value).id){e.n=9;break}return e.p=6,e.n=7,chrome.tabs.sendMessage(l.id,{action:"notifyDevTools",type:"NEW_TEST_GENERATED",data:n});case 7:e.n=9;break;case 8:e.p=8,e.v;case 9:e.n=5;break;case 10:e.n=12;break;case 11:e.p=11,u=e.v,s.e(u);case 12:return e.p=12,s.f(),e.f(12);case 13:e.n=15;break;case 14:e.p=14,p=e.v,console.error("Error notifying DevTools panel:",p);case 15:t({success:!0}),e.n=17;break;case 16:e.p=16,m=e.v,console.error("Error saving test:",m instanceof Error?m.message:"Unknown error"),t({error:m instanceof Error?m.message:"Unknown error"});case 17:return e.a(2)}},e,null,[[6,8],[4,11,12,13],[2,14],[0,16]])}))).apply(this,arguments)}function q(e){return z.apply(this,arguments)}function z(){return(z=h(d().m(function e(n){var t,r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,$();case 1:t=e.v,console.log("üîß Background: Retrieved settings:",t),n({success:!0,settings:t}),e.n=3;break;case 2:e.p=2,r=e.v,console.error("‚ùå Background: Error getting settings:",r),n({error:r instanceof Error?r.message:"Unknown error occurred"});case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function H(e,n){return K.apply(this,arguments)}function K(){return(K=h(d().m(function e(n,t){var r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("üíæ Background: Saving settings:",n),e.n=1,chrome.storage.sync.set({settings:n});case 1:console.log("‚úÖ Background: Settings saved successfully"),t({success:!0}),e.n=3;break;case 2:e.p=2,r=e.v,console.error("‚ùå Background: Error saving settings:",r),t({error:r instanceof Error?r.message:"Unknown error occurred"});case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function Y(e){return V.apply(this,arguments)}function V(){return(V=h(d().m(function e(n){var t,r,o;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,chrome.storage.local.get(["chatHistory"]);case 1:t=e.v,r=t.chatHistory||[],n({success:!0,chatHistory:r}),e.n=3;break;case 2:e.p=2,o=e.v,n({error:o instanceof Error?o.message:"Unknown error occurred"});case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function X(e,n){return Z.apply(this,arguments)}function Z(){return(Z=h(d().m(function e(n,t){var r,o,a;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,chrome.storage.local.get(["chatHistory"]);case 1:return r=e.v,(o=r.chatHistory||[]).push(n),o.length>100&&o.splice(0,o.length-100),e.n=2,chrome.storage.local.set({chatHistory:o});case 2:t({success:!0}),e.n=4;break;case 3:e.p=3,a=e.v,t({error:a instanceof Error?a.message:"Unknown error occurred"});case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function $(){return Q.apply(this,arguments)}function Q(){return(Q=h(d().m(function e(){var n;return d().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,chrome.storage.sync.get(["settings"]);case 1:return n=e.v,e.a(2,n.settings||{selectedFramework:"playwright-ts",selectedAIProvider:"openai",apiKeys:{},selectedModel:{},localSetup:{endpoint:"http://localhost:11434",model:"llama-3.1"},openRouterConfig:{apiKey:"",model:"openai/gpt-3.5-turbo"},connectionStatus:{},autoGenerate:!1,includeComments:!0,usePageObjectModel:!1})}},e)}))).apply(this,arguments)}chrome.runtime.onInstalled.addListener(function(){console.log("AI TestGen extension installed"),chrome.storage.sync.set({settings:{selectedFramework:"playwright-ts",selectedAIProvider:"openai",apiKeys:{},selectedModel:{},localSetup:{endpoint:"http://localhost:11434",model:"llama-3.1"},openRouterConfig:{apiKey:"",model:"openai/gpt-3.5-turbo"},connectionStatus:{},autoGenerate:!1,includeComments:!0,usePageObjectModel:!1}})}),chrome.action.onClicked.addListener(function(){var e=h(d().m(function e(n){var t;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("üñ±Ô∏è Background: Extension icon clicked, opening side panel..."),!chrome.sidePanel||!chrome.sidePanel.open){e.n=2;break}return e.n=1,chrome.sidePanel.open({tabId:n.id});case 1:console.log("‚úÖ Background: Side panel opened successfully"),e.n=3;break;case 2:console.warn("‚ö†Ô∏è Background: Side panel API not available, falling back to popup"),chrome.action.setPopup({popup:"popup.html"});case 3:e.n=5;break;case 4:e.p=4,t=e.v,console.error("‚ùå Background: Failed to open side panel:",t);try{chrome.action.setPopup({popup:"popup.html"})}catch(e){console.error("‚ùå Background: Failed to set popup fallback:",e)}case 5:return e.a(2)}},e,null,[[0,4]])}));return function(n){return e.apply(this,arguments)}}()),chrome.runtime.onMessage.addListener(function(e,n,t){switch(e.action){case"generateTest":return h(d().m(function n(){var r;return d().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,w(e.data,t);case 1:n.n=3;break;case 2:n.p=2,r=n.v,console.error("Error in generateTest handler:",r),t({error:r instanceof Error?r.message:"Unknown error occurred"});case 3:return n.a(2)}},n,null,[[0,2]])}))(),!0;case"saveTest":return h(d().m(function n(){var r;return d().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,J(e.data,t);case 1:n.n=3;break;case 2:n.p=2,r=n.v,console.error("Error in saveTest handler:",r),t({error:r instanceof Error?r.message:"Unknown error occurred"});case 3:return n.a(2)}},n,null,[[0,2]])}))(),!0;case"getSettings":return h(d().m(function e(){var n;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,q(t);case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("Error in getSettings handler:",n),t({error:n instanceof Error?n.message:"Unknown error occurred"});case 3:return e.a(2)}},e,null,[[0,2]])}))(),!0;case"updateSettings":return h(d().m(function n(){var r;return d().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,H(e.data,t);case 1:n.n=3;break;case 2:n.p=2,r=n.v,console.error("Error in updateSettings handler:",r),t({error:r instanceof Error?r.message:"Unknown error occurred"});case 3:return n.a(2)}},n,null,[[0,2]])}))(),!0;case"getChatHistory":return h(d().m(function e(){var n;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Y(t);case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("Error in getChatHistory handler:",n),t({error:n instanceof Error?n.message:"Unknown error occurred"});case 3:return e.a(2)}},e,null,[[0,2]])}))(),!0;case"saveChatMessage":return h(d().m(function n(){var r;return d().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,X(e.data,t);case 1:n.n=3;break;case 2:n.p=2,r=n.v,console.error("Error in saveChatMessage handler:",r),t({error:r instanceof Error?r.message:"Unknown error occurred"});case 3:return n.a(2)}},n,null,[[0,2]])}))(),!0;case"fetchOpenRouterModels":return h(d().m(function n(){var r,o;return d().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,F(e.apiKey);case 1:r=n.v,t({success:!0,models:r}),n.n=3;break;case 2:n.p=2,o=n.v,console.error("Error fetching OpenRouter models:",o),t({error:o instanceof Error?o.message:"Unknown error occurred"});case 3:return n.a(2)}},n,null,[[0,2]])}))(),!0;case"getAllOpenRouterModels":return h(d().m(function n(){var r,o;return d().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,F(e.apiKey);case 1:r=n.v,t({success:!0,models:r}),n.n=3;break;case 2:n.p=2,o=n.v,console.error("Error fetching all OpenRouter models:",o),t({error:o instanceof Error?o.message:"Unknown error occurred"});case 3:return n.a(2)}},n,null,[[0,2]])}))(),!0;default:t({error:"Unknown action"})}})})();